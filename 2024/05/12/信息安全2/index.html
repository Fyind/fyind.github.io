<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>信息安全2 | Fyind's Blog</title><meta name="author" content="Fyind"><meta name="copyright" content="Fyind"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="IT Security 2 Digitale Identität: ID Token Basis für Authentisierung und Autorisierung Formfaktor Smartcard Smardcard可以应用在Mobilfunk, PA, Health, Payment这些领域，它可以用来特殊的安全服务：  2-Faktor-Authentisierung, Si">
<meta property="og:type" content="article">
<meta property="og:title" content="信息安全2">
<meta property="og:url" content="http://fyind.de/2024/05/12/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A82/index.html">
<meta property="og:site_name" content="Fyind&#39;s Blog">
<meta property="og:description" content="IT Security 2 Digitale Identität: ID Token Basis für Authentisierung und Autorisierung Formfaktor Smartcard Smardcard可以应用在Mobilfunk, PA, Health, Payment这些领域，它可以用来特殊的安全服务：  2-Faktor-Authentisierung, Si">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://fyind.de/img/pic1.PNG">
<meta property="article:published_time" content="2024-05-12T20:45:03.000Z">
<meta property="article:modified_time" content="2025-07-18T10:49:53.876Z">
<meta property="article:author" content="Fyind">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fyind.de/img/pic1.PNG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "信息安全2",
  "url": "http://fyind.de/2024/05/12/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A82/",
  "image": "http://fyind.de/img/pic1.PNG",
  "datePublished": "2024-05-12T20:45:03.000Z",
  "dateModified": "2025-07-18T10:49:53.876Z",
  "author": [
    {
      "@type": "Person",
      "name": "Fyind",
      "url": "http://fyind.de"
    }
  ]
}</script><link rel="shortcut icon" href="/img/pic1.PNG"><link rel="canonical" href="http://fyind.de/2024/05/12/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A82/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '信息安全2',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://fyindex.work/PicGo/liuyin.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/pic1.PNG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">85</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">83</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/categories/TUM%E7%AC%94%E8%AE%B0"><i class="fa-fw fas fa-folder-open"></i><span> TUM笔记</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/yae.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Fyind's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">信息安全2</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/categories/TUM%E7%AC%94%E8%AE%B0"><i class="fa-fw fas fa-folder-open"></i><span> TUM笔记</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">信息安全2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-05-12T20:45:03.000Z" title="Created 2024-05-12 20:45:03">2024-05-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-18T10:49:53.876Z" title="Updated 2025-07-18 10:49:53">2025-07-18</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="it-security-2">IT Security 2</h1>
<h2 id="digitale-identität-id-token">Digitale Identität: ID Token</h2>
<p>Basis für Authentisierung und Autorisierung</p>
<h3 id="formfaktor-smartcard">Formfaktor Smartcard</h3>
<p>Smardcard可以应用在Mobilfunk, PA, Health,
Payment这些领域，它可以用来特殊的安全服务：</p>
<ul>
<li>2-Faktor-Authentisierung, Sicherer Speicher, Secure Boot •
Schlüssel-Generierung, -Speicherung, Signieren, Verschlüsseln</li>
</ul>
<blockquote>
<p>FormFaktor 波形因数</p>
</blockquote>
<p>Smardcard分类</p>
<ul>
<li>Kontaktlose Karte 无接触的</li>
<li>Kontaktbehaftete Karte</li>
<li>Protokolle</li>
</ul>
<p>ISO/IEC Standard 7816</p>
<h3 id="mikrocontroller-architektur">Mikrocontroller-Architektur</h3>
<figure>
<img src="https://fyindex.work/PicGo/image-20240512212417348.png"
alt="image-20240512212417348" />
<figcaption aria-hidden="true">image-20240512212417348</figcaption>
</figure>
<h4 id="control">Control</h4>
<ul>
<li><p>Reset</p>
<p>可以通过读卡器触发，对于非接触式卡：如果场强不足，重置，因为
内部张力崩溃</p></li>
<li><p>Clock</p>
<p>根据电压设定频率，会在Testmodus和Betriebsmodus切换</p></li>
<li><p>Power Management</p>
<p>不需要的电路部分的时钟关闭 优化当前配置文件</p></li>
</ul>
<h4 id="optionale-co-prozessoren">Optionale Co-Prozessoren</h4>
<p>Symmetrische Kryptografie: 比软件快100倍</p>
<p>Asymmetrische Kryptografie: 小于10s RSA密钥生成,
小于1sRSA加密，签名</p>
<p>问题：会被Seitenkanalangriffe</p>
<h3 id="ausgewählte-angriffe">1.3 Ausgewählte Angriffe</h3>
<h4 id="passive-angriffe">Passive Angriffe</h4>
<ol type="1">
<li>Microprobing
使用非常精细的探针直接接触和监测芯片内部的总线信号或输入/输出（I/O）接口信号。通过这种方式，攻击者可以窥探芯片内部的数据流动，获取敏感信息，比如解密密钥、传输中的数据等。</li>
<li>Mikroskop显微镜攻击:使用光学显微镜对芯片上的只读存储器（ROM）结构进行逆向工程，或者直接读取存储单元的内容。通过这种手段，攻击者可以分析芯片的物理结构，进而解读存储器中的数据。</li>
<li>侧信道分析</li>
</ol>
<h4 id="aktive-angriffe">Aktive Angriffe</h4>
<ol type="1">
<li>UV-Licht
紫外光：通过紫外线照射，释放或清空EEPROM（电可擦可编程只读存储器）的存储单元，进行数据操控。</li>
<li>Lichtblitze (Laser) 激光脉冲：Fehlerinjektion篡改寄存器中的值</li>
<li>Störimpulse干扰脉冲: Glitch操纵其控制流</li>
</ol>
<h4 id="manipulation-der-externen-control-peripherals">Manipulation der
externen Control Peripherals</h4>
<p><strong>限制写入操作</strong>：通过降低电源电压（例如，将VCC设置得过低）来防止智能卡进行写入操作。这可以干扰设备的正常功能</p>
<p><strong>更改时钟频率</strong>：通过控制时钟输入来改变卡片的操作速度，例如提高时钟频率以跳过某些指令，甚至忽略跳转指令。这种操作可能导致错误行为或安全漏洞。</p>
<h4 id="zusätzliche-angriffspunkte">Zusätzliche Angriffspunkte</h4>
<p>Externe
Softwarebibliotheken<strong>外部软件库</strong>：这些库虽然用于支持智能卡的功能，但往往成为攻击目标，类似于加密库的漏洞，攻击者可以利用这些漏洞来入侵系统</p>
<p>Unterbrechen der Verbindung zum Terminal
<strong>中断与终端的连接</strong>：通过中断智能卡与读取器的通信，可能会造成服务中断或拒绝服务（Denial-of-Service）<strong>窃听/操控通信</strong>：通过“中间人攻击”（Man-in-the-Middle），攻击者可以窃听或篡改智能卡和终端之间的通信，伪造或操控数据传输</p>
<h3 id="seitenkanalangriffe">Seitenkanalangriffe</h3>
<ul>
<li>Timing-Attacke</li>
<li>Power-Analysis</li>
</ul>
<h3 id="spezielle-schutzmaßnahmen-für-mikrocontroller">Spezielle
Schutzmaßnahmen für Mikrocontroller</h3>
<h4 id="generelle-abwehrmaßnahmen">Generelle Abwehrmaßnahmen</h4>
<p><strong>冷启动攻击（Cold-Boot
Attack）</strong>：通过关闭系统电源后，冻结RAM，然后重新启动系统并使用最小操作系统（Minimal
OS）来读取RAM中的内容。这种攻击可以让攻击者在几分钟内获取系统中的数据。</p>
<ul>
<li>(Aktiv)主动防御Erkennen durch Sensorik: Spannung, Licht (optischer
Zugriff wird erkannt), Temperatur</li>
<li>增强复杂度Erschweren durch Obfuskation, Maskierung</li>
<li>添加额外的保护层Einbringen zusätzlicher Schutzschichten</li>
</ul>
<h4 id="sicherheitsmaßnahmen">Sicherheitsmaßnahmen</h4>
<ul>
<li>Chip-Design: Scrambling der Busse: Funktionszuordnung
verschleiern</li>
<li>Interne
Busse内部的地址、数据、控制总线不暴露在外，无法被外部设备直接访问或操控。这种设计防止外部对总线进行干扰或监听。</li>
<li>将ROM移入更深的硅层Verlagerung des ROMs in tiefere
Siliziumschichten,um Reverse-Engineering des Betriebssystems zu
erschweren</li>
<li>通过离子植入技术加固ROM代码Ionenimplantierte
ROM-Codes通过向硅片中注入杂质来改变材料的电导性，这种做法有效防止使用光学显微镜读取ROM内容。</li>
</ul>
<h4 id="einführung-spezieller-schichten-shielding">Einführung spezieller
Schichten (Shielding)</h4>
<p>防止通过电磁辐射（如EMA，即电磁分析）读取存储单元中的数据。</p>
<ul>
<li><p>Stromführende Metallschicht<strong>通电金属层</strong>:
使用金属屏蔽层来保护芯片</p></li>
<li><p>Passivierungsschicht (lichtundurchlässig) für
RAM<strong>RAM的钝化层（光不透层）</strong>:
这种层用于阻止光学攻击，因为移除这层将暴露存储器，且当芯片暴露在光线下时，它会自动关闭。</p></li>
</ul>
<h4 id="einführung-spezieller-sensoren">Einführung spezieller
Sensoren</h4>
<p>检测潜在的攻击行为，确保芯片在面对物理攻击时具备防护能力。</p>
<ul>
<li><strong>光感传感器</strong>:
可以检测到光的变化，特别是用于防御激光闪光攻击。</li>
<li><strong>温度传感器</strong>:
用于防止通过超频（即提升芯片工作频率）来制造错误或篡改数据。</li>
<li>Widerstands<strong>电阻或电容传感器</strong>:
用来检测保护层是否完好无损。如果保护层被去除或损坏，这些传感器可以发现并触发相应的防护机制。</li>
</ul>
<h4 id="verschlüsselung-von-internem-speicher">Verschlüsselung von
internem Speicher</h4>
<ul>
<li><p>Non volatiler (persistenter) Speicher: ROM,Flash, Nutzung z.B.
XTS</p></li>
<li><p>Volatiler Speicher: Ziel: keine
Performanzeinbußen,加密这些区域必须避免明显的性能下降</p>
<p>通过在设备启动时生成临时密钥（Ephemeral
Key）并对数据进行异或加密，可以在一定程度上实现低开销的保护</p>
<p>Schlüsselerneuerung: bei erneutem Power-up <strong>密钥管理</strong>:
这种方法依赖于在每次启动时生成新的密钥，避免了长期存储密钥带来的安全风险。然而，这也意味着设备断电后，存储在
RAM 中的数据无法恢复</p></li>
</ul>
<h3 id="smartcard-secure-element-als-physischer-idtoken">Smartcard,
secure Element als physischer IDToken</h3>
<p>智能卡（Smartcard）和安全元素（Secure
Element）被广泛用于身份验证，不仅可以验证<strong>个人</strong>的身份，还可以验证<strong>设备</strong>的身份</p>
<ul>
<li><p>Credentials sind im Chip der Karte gespeichert</p></li>
<li><p>‚Entsperren‘ der Karte nach
Besitzer-Authentisierung在用户<strong>成功认证</strong>之后，卡片的功能才会被解锁</p></li>
<li><p>Authentisierung gegenüber Terminal/Rechner/Serve 双因素认证</p>
<ul>
<li>Faktor Wissen: PIN Eingabe,PIN
码在卡片的<strong>EEPROM</strong>中存储，并由卡片自身来进行验证</li>
<li>Faktor Besitz: physischen Besitz der Karte
nachweisen对称认证：使用卡片中的<strong>预共享密钥
k</strong>进行加密挑战响应,非对称认证：使用用户私钥（如
dA）进行加密证明，表明用户拥有私钥</li>
<li>Smartcard führt Kommandos aus, z.B. Verify CHV (Card
Holder终端设备（如计算机、服务器、读卡器）是客户端，向智能卡发送命令，卡片根据其内部存储的密钥和凭据进行相应的操作</li>
</ul></li>
</ul>
<figure>
<img src="https://fyindex.work/PicGo/image-20240925185121983.png"
alt="image-20240925185121983" />
<figcaption aria-hidden="true">image-20240925185121983</figcaption>
</figure>
<h4 id="aushebeln-des-fehlversuchszählers-im-eeprom">Aushebeln des
Fehlversuchszählers im EEPROM</h4>
<p>Chip benötigt höhere Spannung für Schreib- als für
Lesezugriffe如果将供电电压（VCC）设置得只允许进行读取操作，攻击者可以无限制地尝试输入
PIN，而不会增加错误计数器。这使得对 PIN 进行暴力破解成为可能</p>
<h4 id="angriff-durch-nutzung-eines-unsicheren-card-readers">Angriff
durch Nutzung eines unsicheren Card-Readers</h4>
<p>攻击者利用不安全或被篡改的读卡器来拦截 PIN 码</p>
<h3 id="pace-password-authenticated-connection-establishment">PACE
(Password Authenticated Connection Establishment)</h3>
<h2 id="identitätsmanagement-im">Identitätsmanagement (IM)</h2>
<h3 id="single-sign-on-konzept">Single-Sign-On Konzept</h3>
<p>使用服务需要输入密码</p>
<h4 id="问题">问题：</h4>
<ul>
<li>每个人需要对每个服务输入密码</li>
<li>敏感数据在很多计算机上</li>
</ul>
<h4 id="解决single-sign-on-sso">解决Single-Sign-on SSO</h4>
<p>用户的credentials在被信任的AuC(Authentication Center)</p>
<p>AuC给这个服务Authentizitätstoken</p>
<p>这个服务来验证这个token的合法性</p>
<h4 id="konsequenz-aufgaben-trennung-ist-möglich">Konsequenz:
Aufgaben-Trennung ist möglich</h4>
<p>Authentisierung durch AuC: Policy Decision-Point, PDP.</p>
<p>Prüfung auf Gültigkeit durch Dienst: Policy-Enforcement-Point,
PEP</p>
<h4 id="föderierte-identitäten联合身份">Föderierte
Identitäten联合身份</h4>
<p>用户先向Identitätsprovider IdP亲求一个身份的Token,
用户把Token发送给服务商(SP) , SP验证Token</p>
<h4 id="im-protokolle-in-der-praxis">IM-Protokolle in der Praxis</h4>
<ul>
<li><p>Kerberos-Protokoll: 在企业内部用，无云服务</p></li>
<li><p>Shibboleth:
用于跨组织边界的Web应用程序身份认证和授权管理Authentisierungs- und
Autorisierungs-Infrastruktur für Web- Anwendungen, ID Management über
Org-Grenzen hinweg u.a. umgesetzt an der TUM, LRZ, LMU, BAdW</p></li>
<li><p>OpenID Connect basierend auf OAuth 2.0:
主要用于Web应用程序的身份认证Offener Industrie-Standard für
Web-Anwendungen, u.a. Google, Amazon, Facebook, GitHub, Dropbox,
Twitter</p></li>
<li><p>SSI: Self Souvereign Identity: selbstbestimmtes, dezentrales
IDM指用户拥有并完全控制自己的身份，而不依赖于集中化的身份提供者。这是一种去中心化的身份管理方式</p></li>
</ul>
<h3 id="kerberos-system">Kerberos-System</h3>
<p>有三个角色：用户，KDC(里面有 AS, TGS)， AD</p>
<ul>
<li><p>用户先访问AS，提供principle,password,
AS鉴定是不是本人通过查询AD</p></li>
<li><p>然后AS返回用户TGT(Ticket Granting Ticket)</p></li>
<li><p>用户使用TGT访问TGS, TGS验证TGT并且检查访问服务的权限(查询AD),
返回 ST</p></li>
<li><p>用户用ST 访问服务</p></li>
</ul>
<figure>
<img src="https://fyindex.work/PicGo/image-20240926181841577.png"
alt="image-20240926181841577" />
<figcaption aria-hidden="true">image-20240926181841577</figcaption>
</figure>
<h3 id="shibboleth">Shibboleth</h3>
<p>是AAI(Authentisierungs- und Autorisierungsinfrastruktur)</p>
<ul>
<li>Web-basiertes SSO für Web-Anwendungen</li>
<li>Föderierte Identitäten联合的身份</li>
<li>Nutzer authentisiert sich bei Identitäts Provider IdP</li>
<li>SAML-Assertions für Bestätigungen des ID Providers</li>
</ul>
<p>由 IdP, SP(Service Provider), DS(Discovery Service)组成</p>
<figure>
<img src="https://fyindex.work/PicGo/image-20240926183113550.png"
alt="image-20240926183113550" />
<figcaption aria-hidden="true">image-20240926183113550</figcaption>
</figure>
<h3 id="openid-connect-basierend-auf-oauth-2.0">OpenID Connect basierend
auf OAuth 2.0</h3>
<h4 id="oauth-2.0">OAuth 2.0</h4>
<p>授权框架，旨在允许第三方应用程序在不共享用户密码的情况下，安全地访问用户存储在其他服务（如社交媒体、云存储等）上的资源</p>
<p>Der Ressource-Owner(RO) bestimmt, wer, welche Rechte erhält.</p>
<p>OpenID Connect: Erweiterung des OAuth-Frameworks</p>
<p>RO:在 OAuth
中，资源拥有者通常是用户，他们拥有某些资源（例如照片、文件），并有权决定谁可以访问这些资源。</p>
<p>Resource Server (RS) 资源服务器是存储和管理资源的服务器</p>
<p>比如，Alice有在Facebook存照片，Alice手机里有一个Kalender
APP。Kalender需要访问Alice的照片。那么</p>
<ol type="1">
<li>Alice给Kalender权限，</li>
<li>Kalender把权限发给AS, AS返回一个Token</li>
<li>Kalender通过Token访问Facebook</li>
</ol>
<h4 id="openid-connect">OpenID Connect</h4>
<ol type="1">
<li><p>Client发送AS说它要确认RO的权限</p></li>
<li><p>AS检查URI,
对RO确认身份，并且拿到Rechtedelegation，准备Authorization Code</p></li>
<li><p>Client 用Authorization Code 在AS交换 Access Token</p></li>
<li><p>AS 生产一个对于确认授权的ID Token并且签名发给Client</p></li>
<li><p>Client检查签名</p></li>
</ol>
<h3 id="self-sovereign-identity-ssi">Self-sovereign Identity (SSI)</h3>
<p><strong>DID 是一种 URL</strong>：DID（Decentralized
Identifier，去中心化标识符）是指向一个 DID 文档的
URL。这个文档包含关于如何验证与该 DID 关联的身份的信息。</p>
<p>DID 经常与可验证声明（Verifiable Claims）一起使用。Verifiable Claims
是指可以被验证的身份属性或声明，通常由可信的实体（Issuer）签名，以证明某些身份信息的真实性。</p>
<p>用户可以通过这些经过验证的身份属性来证明其身份。</p>
<p>用户可以从多个不同的发布者（如政府、学校、公司等）获得 Verifiable
Claims，并将这些身份声明提交给一个需要验证用户身份的网站或验证者（Verifier）。这样，用户的身份由多个实体共同验证，提高了身份信息的可信度</p>
<h2 id="kapitel-3-hardware-basierte-sicherheit">Kapitel 3
Hardware-basierte-Sicherheit</h2>
<p>Spezielle Chips: Hardware Security Modules (HSM), Beispiel: TPM</p>
<p>Hardware-Erweiterung: Trusted Execution Environment (TEE), Bsp.:
Intel SGX</p>
<h3 id="trusted-computing">Trusted Computing</h3>
<h4 id="trust-building-blocks-der-tc-plattform">Trust Building Blocks
der TC-Plattform</h4>
<p>TPM: Trusted Platform Module</p>
<p>CRTM: Core Root of Trust for Measurement: BIOS-Erweiterung, erster
Schritt bei einem sicheren Boot-Vorgang Messen: Hashwerte berechnen</p>
<h4 id="features-des-tpm">Features des TPM</h4>
<ul>
<li><p>Krypto-Primitive: Generator für symmetrische und asymmetrische
Schlüssel • Signaturerstellung, Hashen, Ver- und
Entschlüsselung</p></li>
<li><p>Eindeutige Chip-ID, wird als asymmetrischer Schlüssel
konfiguriert, der sogenannte <strong>Endorsement Key (EK)</strong> <span
class="math inline">\((e_{EK}, d_{EK})\)</span>
厂商生产的，用于非对称加密， 敏感数据用e加密, 解密用d,
需要OwnerPassword来访问d</p></li>
<li><p>In Besitznahme der Plattform durch einen Nutzer, OAK =
SHA(Owner_Passwort), Owner-Authentication Key , OAK nur im TPM
gespeichert, shared secret 用户通过 <strong>Take_Ownership 命令</strong>
来掌控 TPM，并设定一个所有者密码（Owner Password）,<strong>OAK</strong>
只在 TPM 内部存储，TPM 和所有者通过共享密钥机制确保安全通信</p></li>
<li><p>PCR-Register: Speicherung von Hashwerten von geladenen
Systemmodulen存储系统模块的Hash值</p></li>
<li><p>Integritätsmessung/Reporting</p>
<ul>
<li>Messen：测量数据的Hash值</li>
<li>Reporting: 收到外部请求时，TPM
可以生成一个完整性报告，该报告包含指定的 PCR
寄存器的值。这些寄存器中的哈希值反映了系统的启动状态或其他受监控的活动。</li>
</ul></li>
<li><p>Attestierung 确保系统的可信度和完整性</p></li>
</ul>
<p>​ 报告生成时，会包含一个
<strong>Nonce</strong>（一次性随机数）。这个随机数确保了每次生成的报告都是唯一的，并且防止重放攻击。为了保证报告的真实性，TPM
使用 <strong>AIK（Attestation Identity Key，证明身份密钥）</strong>
对报告进行签名。AIK动态可生成。报告生成后，外部实体可以使用 AIK
的公钥（eAIK）来验证签名的合法性</p>
<ul>
<li>Sealing 用于将数据与平台特定的状态绑定起来，通过利用
PCR（平台配置寄存器）中的值对数据进行加密。<strong>Sealing</strong>
过程使用 TPM 的内部公钥对数据进行加密，同时将某些 PCR
寄存器的值作为额外的参数，当系统处于指定的 PCR
状态时，并且可以访问RSA私钥，TPM
可以解密并提供数据，否则解密操作将失败。加密后的数据结果是一个加密块（<strong>c</strong>），该块可以存储在
TPM 之外，例如存储在硬盘上。</li>
</ul>
<h4 id="tpm-schlüsselhierarchie">TPM-Schlüsselhierarchie</h4>
<p>TPM
中的密钥以层次结构的形式组织，这个层次结构用于对密钥进行封装和管理。密钥之间存在父子关系：子密钥由父密钥进行“包装”（加密），以确保子密钥的安全性</p>
<p>Storage-Root-Key (SRK): <strong>SRK</strong>
是整个密钥层次结构的根密钥，位于 TPM 的顶层。在<strong>Take
Ownership</strong>（拥有权接管）时由 TPM 内部生成，并且<strong>私钥 dSRK
永远不会离开 TPM</strong></p>
<h4 id="nutzen-der-schlüsselhierarchie">Nutzen der
Schlüsselhierarchie</h4>
<p>TPM 密钥层次结构的主要用途是确保敏感数据在 TPM
外部也能得到安全的存储</p>
<p>在 TPM 中生成一个密钥 <strong>k</strong> 或一个密钥对 <strong>(ek,
dk)</strong>，其中 <strong>ek</strong> 是公钥，<strong>dk</strong>
是私钥</p>
<p>私钥 <strong>dk</strong> 会通过其父密钥的公钥
<strong>eparent</strong> 加密，这个过程被称为 “封装” 或 “wrapping”。</p>
<p>父密钥的公钥 <strong>eparent</strong>
被称为<strong>封装密钥</strong>或<strong>绑定密钥</strong>（wrapping key
或 binding key），用于加密子密钥（即 <strong>dk</strong>）。</p>
<p>这样，即使私钥被 TPM
导出，它依然是加密的，只有使用父密钥才能解密，从而保证私钥的安全。</p>
<h4 id="measured-boot">Measured Boot</h4>
<p><strong>CRTM, Core Root of Trust for Measurement）</strong>：</p>
<ul>
<li>CRTM 是 Measured Boot 的起始点，通常是 BIOS
的一个扩展模块。它是一系列静态的 CPU 指令，通常由芯片制造商签名。</li>
<li>当计算机启动时，CRTM 首先运行，并负责测量（哈希）BIOS 的完整性</li>
</ul>
<p><strong>完整性测量</strong>是在加载每个固件或软件组件之前进行的。这意味着在系统启动过程中，每当要加载新的组件时，都会进行一个完整性检查</p>
<p>• Inkrementelles Vorgehen <span class="math display">\[
\operatorname{PCR}(i)_{t-1}=\mathrm{SHA}-1\left[\mathrm{PCR}(i)_t
\mid\right. \text { 新的测量 }]
\]</span> UEFI (Unified Extensible Firmware Interface): secure boot ohne
TPM</p>
<p>在没有
TPM（受信任的平台模块）的情况下，安全启动也可以通过验证执行文件的签名哈希值来实现。这个过程包括：</p>
<ul>
<li>启动引导加载程序，该加载程序将加载操作系统内核。</li>
<li>加载内核后，继续加载驱动程序等。</li>
<li>如果在任何点上验证失败，系统将停止启动（fail-safe），确保不运行未授权的代码</li>
</ul>
<p>UEFI 的安全启动功能可以与 TPM
的测量启动功能结合使用，以增强安全性</p>
<h4 id="attestierung">Attestierung</h4>
<p>尽管 TPM 可以生成签名，但并非所有的签名都应该直接与 TPM
芯片本身关联。这是为了保护用户的隐私，防止通过签名识别设备或用户</p>
<p>为了实现隐私保护，使用了<strong>AIK（Attestation Identity
Key）</strong>密钥对：</p>
<p><strong>隐私 CA（Certificate
Authority）</strong>：是一个可信的第三方机构，负责签署 eAIK
公钥，以便证明其有效性。</p>
<h3 id="trusted-execution-environment-tee---信任执行环境">Trusted
Execution Environment (TEE) - 信任执行环境</h3>
<p>在传统操作系统中，存在不同的<strong>特权级别</strong>（Privilege
Levels),
操作系统缺乏对<strong>特权进程</strong>的防护，特权进程拥有对所有数据的访问权限。这在一些场景中可能会引发安全隐患，尤其是在云计算和边缘计算环境中</p>
<p>TEE: Schutz der Daten/Code in-use, während der
Verarbeitung.防止它们被同一系统中的其他进程、操作系统、虚拟机管理程序或云服务提供商访问。</p>
<p>与 TPM 等外部硬件模块不同，TEE
通常是集成在<strong>标准处理器</strong>中的，不需要额外的独立芯片。</p>
<p>TEE
通过提供可验证的<strong>认证机制</strong>，允许应用程序向第三方证明其运行环境的可信度</p>
<h4 id="intel-software-guard-extensionssgx">Intel Software Guard
Extensions(SGX)</h4>
<p>是英特尔于 2015 年引入的一种 CPU
指令集扩展,应用程序在开发时可以被划分为<strong>安全（secure）</strong>和<strong>非安全（non-secure）</strong>部分。敏感的操作和数据存储在安全部分中，而普通的操作放在非安全部分</p>
<p>SGX 的核心概念是
<strong>Enclave</strong>，它是一个<strong>安全区</strong>，用于在应用程序中隔离和保护敏感代码和数据。</p>
<p>EPC (Enclave Page Cache) :EPC 是一个用于存储 Enclave
的特殊内存区域，所有存储在其中的页都是加密的。EPC 中的页由专用的 MEE
加密和解密. 只有当 EPC 页在处理器核心内部时，才会被解密。这意味着 EPC
数据在内存传输过程中始终是加密状态</p>
<p>每个 Enclave 都通过一个 <strong>Hash 值</strong>
来表示。这个哈希值包含了 Enclave
的<strong>属性</strong>（如权限、配置等）以及其<strong>内存内容</strong>，确保
Enclave 的状态可以通过一个唯一的值进行验证</p>
<p>使用 <strong>Attestation Key（认证密钥）</strong>
对测量值进行签名，从而生成 Enclave 的认证报告。这确保了 Enclave
的状态能够被远程验证。Betriebssystem hat keinen Zugriff auf die
Enclave!</p>
<p>缺点：</p>
<p><strong>无法隔离整个虚拟机</strong>：SGX
只能保护特定的应用程序或代码部分，无法对整个 VM 进行隔离保</p>
<p><strong>应用程序必须划分为安全和非安全部分</strong>：开发者需要将应用程序划分为“安全”和“非安全”部分，增加了编程的复杂性。</p>
<p><strong>受限的隔离内存</strong>：SGX 的内存隔离有限（如 128MB
EPC），无法满足大规模的应用需求</p>
<h4 id="intel-trusted-domain-extensions-tdx">Intel Trusted Domain
Extensions (TDX)</h4>
<p>是一种新兴的硬件增强技术，用于解决 Intel SGX 中的限制。</p>
<p><strong>隔离整个虚拟机</strong> ： 在 TDX
中，整个虚拟机可以被隔离，称为<strong>可信域（Trusted Domain,
TD）</strong></p>
<p><strong>隔离虚拟机管理程序（VMM）和所有非可信域组件</strong>：TDX
隔离了虚拟机管理程序（VMM）和其他非可信的系统组件，防止这些高权限的程序访问或篡改
VM 的数据。</p>
<p><strong>SEAM 模式（Secure Arbitration Mode）</strong></p>
<p>TDX 引入了一个新的 CPU 运行模式，称为
<strong>SEAM（安全仲裁模式）</strong>，用来管理安全模块的执行。具体特点如下：</p>
<ul>
<li><strong>TD
安全模块</strong>运行在<strong>保留的内存区域</strong>中。</li>
<li>该安全模块由 <strong>Intel
签名</strong>（以保证其可信性），但内容并<strong>未加密</strong>，以确保系统透明性</li>
</ul>
<p><strong>加密和完整性保护</strong>：TDX
提供了硬件级别的加密保护和完整性验证，确保 VM
内部的数据和代码不被篡改</p>
<p>TDX 使用 <strong>Extended Page Table (EPT)</strong>
来进行地址映射。尽管 EPT 由 VMM 管理，但 VMM 无法访问实际的 TD
内存内容，因为这些内容是加密的。</p>
<p>TDX 支持 <strong>远程认证（Remote
Attestation）</strong>，允许外部的信赖方验证系统的可信状态。</p>
<h4 id="amd-secure-encrypted-virtualization-sev">AMD Secure Encrypted
Virtualization (SEV)</h4>
<p>Secure Memory Encryption (SME): Daten im DRAM AES-verschlüsselt</p>
<p>Secure Encrypted Virtualization (SEV)SEV 是 SME
在虚拟化环境中的应用,确保每个 VM 的内存是独立加密的</p>
<p>每个虚拟机通过一个 <strong>Address Space ID (ASID)</strong>
来标识。这个 ASID
用于绑定特定的加密密钥与相应的虚拟机内存，从而确保不同虚拟机之间的内存数据彼此隔离</p>
<p>在虚拟机初始化时，<strong>Platform Security Processor (PSP)</strong>
生成一个专用的 AES 密钥，用于加密和解密该虚拟机的内存。</p>
<p>可信执行环境（Trusted Execution Environments,
TEE）正变得愈发重要。TEE 支持 <strong>机密计算（Confidential
Computing）</strong>
这一关键概念，旨在在数据和代码执行过程中提供保护,相比传统的基于
<strong>TPM（Trusted Platform Module）</strong> 的方法，TEE
提供了更广泛的保护范围。</p>
<h2 id="ios-sicherheit">iOS Sicherheit</h2>
<p>Apple 采用了<strong>封闭世界（Closed
World）</strong>的安全模式，这意味着整个 iOS
生态系统从硬件到软件再到应用程序，都由 Apple 自主设计和严格控制。</p>
<h3 id="ios-安全架构">iOS 安全架构</h3>
<p><strong>Secure Enclave 处理器（SEP）</strong>：这是 iOS
设备中独立于主处理器的一个安全协处理器，专门用于处理和保护敏感数据，如加密密钥和生物识别信息（如
Face ID 和 Touch ID 数据）</p>
<p>系统安全：Secure Boot, Dateisystem-Sicherheit, Secure Update, Remote
Wipe</p>
<p>应用和服务安全：sichere Ausführungsumgebung für Apps (Sandbox),
Services</p>
<p>网络安全：Standardprotokolle: TLS, IPv6, VPN, WiFi, Bluetooth,</p>
<p>Application Processor，AP
untrusted由于它需要处理大量来自用户和应用程序的数据，因此被视为不受信任的组件。AP
可能会受到恶意软件攻击或利用，因而不能完全信任其安全性。</p>
<p>Secure Enclave Processor，SEP
trusted它能够执行高度敏感的任务，如存储和处理生物识别数据（如指纹和面部识别），并且该数据始终保存在受保护的环境中</p>
<p><strong>安全擦除存储（Effaceable Storage）</strong></p>
<ul>
<li><strong>安全删除</strong>：安全擦除存储是指对存储在 NAND
闪存单元中的数据进行安全删除的机制。与传统的删除操作不同，安全删除意味着在设备重置或用户请求删除数据时，SEP
可以直接访问 NAND
闪存单元，并通过将存储内容覆盖或清除来确保数据无法恢复。这种直接操作的好处是避免了常规存储中的磨损均衡（Wear-Leveling）机制</li>
</ul>
<h3 id="hardware-sicherheit">Hardware-Sicherheit</h3>
<p>Boot ROM: Hardware Root of Trust für sicheres Boot für iOS, sepOS</p>
<p>Secure Enclave Prozessor (SEP)</p>
<ul>
<li>Ko-Prozessor,为了保护用户数据和AP(Application Prozessor)分离,独立OS,
Boot-ROM,Secure Boot, secure OS-Update</li>
<li>AES Engine in SEP: 非常快的AES-XEX读写，IOS和CPU不能访问key</li>
</ul>
<h4 id="sep-schlüssel">SEP-Schlüssel</h4>
<ul>
<li>Eindeutige Geräte-UID (UID) 从生产商生成, 只能在SEP里用
<ul>
<li>在 Silizium 实现, Debug不能读取</li>
<li>实现一个设备的加密数据Binding</li>
</ul></li>
<li>GruppenID 对于相同的Prozessor-Familie
相同，从生产商导入，只能在SEP里用</li>
</ul>
<p>在 <strong>sepOS</strong>（Secure Enclave 操作系统）启动时，SE Boot
ROM 会生成一个<strong>短暂的密钥
Keph</strong>。这是一个用于内存加密的临时密钥,生成的 Keph
与设备的唯一标识符（<strong>UID</strong>）结合，形成新的组合密钥：<strong>Keph
|| UID</strong></p>
<p>Secure Enclave 的内存（如 RAM）通过<strong>AES</strong>
算法使用这个组合密钥 <strong>Keph || UID</strong> 进行加密</p>
<p>生成的 Keph 存储在<strong>Encryption Controller
Register</strong>（加密控制器寄存器）中，并且只在当前启动会话期间有效。</p>
<p>当设备重新启动时，Keph 会被新生成的密钥替换。</p>
<h3 id="passcodes">Passcodes</h3>
<p>解锁设备的密码，用于验证用户身份，解锁设备</p>
<h4 id="master-key">Master Key</h4>
<p>可以导出Master-Keys MS: MS=KDF(passcode, UID, salt), MS
不会被存储，而是根据需要导出。在访问特定数据的时候会用到MS，输入密码会充置MS.
当用户输入密码时，主密钥 MS
被重新生成并用于解密数据。一旦用户完成对数据的访问，MS 就会被销毁。</p>
<h4 id="密码与设备-uid-绑定">密码与设备 UID 绑定</h4>
<p>由于密码与设备唯一标识符（UID）绑定，攻击者无法将加密数据转移到其他设备进行破解。这意味着所有的暴力破解攻击必须在设备本身进行，限制了攻击的范围和可操作性</p>
<p>会人工延迟验证密码的时候，在用户连续输入错误密码时，<strong>延迟机制</strong>会显著增加破解密码所需的时间：</p>
<ul>
<li>例如，在 4 次错误后，需要等待 1 分钟。</li>
<li>在 9 次错误后，等待时间可能会延长到 8 小时。</li>
</ul>
<p>通过这种方式，即使密码较短，攻击者也难以通过快速尝试大量密码来进行暴力破解。</p>
<p>延迟机制由设备的<strong>Secure
Enclave（安全隔区）</strong>处理，意味着这种保护是在硬件级别实现的，不受操作系统层面的攻击影响。</p>
<p>用户可以配置策略，使设备在 10 次密码错误后自动触发
<strong>远程擦除（Remote
Wipe）</strong>。此功能会删除用于解密文件系统的密钥（文件系统密钥
K），从而使设备上的加密文件无法被解密，保证数据不会落入攻击者手中。</p>
<h4 id="biometrie-face-id-und-touch-id">Biometrie: Face ID und Touch
ID</h4>
<p>iOS 通过 <strong>Face ID</strong> 和 <strong>Touch ID</strong>
提供便捷的身份验证方法，生物识别数据（如面部或指纹信息）从传感器传输至设备的
<strong>Secure Enclave Processor（SEP）</strong>
时，数据是加密的，确保传输过程中的隐私和安全。在 SEP
中，生物识别数据会与存储的参考模板进行匹配，验证身份</p>
<p>即使设备使用了 Face ID 或 Touch
ID，某些敏感操作仍然需要用户输入密码：</p>
<p>Software Update, Device löschen; nach Restart; Anzeigen oder Ändern
der Passwortdaten; Installation oder Konfiguration von Profilen; Unlock
mit Passcode nach mehr als 48 Stunden; Nutzer hat seinen Passcode mehr
als 6.5 Tage nicht genutzt und keine biometrische unlock-Aktion über 4
Stunden durchgeführt. Nach 5 nicht erfolgreichen biometrischen
Zugangsversuchen.</p>
<h3 id="datei-schutz-data-protection">Datei-Schutz, Data Protection</h3>
<p>保护在A处理器，存储器中的数据</p>
<p>在设备首次<strong>安装</strong>或<strong>擦除</strong>（Wipe）时，会自动生成一个用于保护文件系统的主密钥
<strong>K</strong>，对于每个文件，系统会生成一个独立的 <strong>AES 256
位文件密钥 DK</strong>，用于对文件进行加密</p>
<p>根据文件的安全需求，每个文件在生成时由其所属的应用程序指定一个安全级别：</p>
<ol type="1">
<li><p><strong>无保护 (No
Protection)</strong>：文件只通过设备绑定和文件系统密钥
<strong>K</strong> 进行保护。</p></li>
<li><p><strong>保护到首次用户认证 (Protected until First User
Authentication)</strong>：文件受到保护，直到用户第一次通过设备认证（如解锁设备）</p></li>
<li><p><strong>除非打开，否则受保护 (Protected unless
Open)</strong>：该级别下的文件一直受保护，直到用户打开该文件。</p>
<p>如果文件没有被主动打开，即便设备已经解锁，它仍处于加密状态</p></li>
<li><p><strong>完全保护 (Complete Protection)</strong>：</p>
<p>文件在设备锁定后仍处于加密状态，直到用户重新进行身份认证。这种保护级别确保即使设备解锁后未被使用，文件也不会被自动解密</p></li>
</ol>
<p>每个安全级别都有一个相应的 <strong>256位 AES 类密钥
CK</strong>，用来对该级别的文件进行加密</p>
<h4 id="文件加密过程">文件加密过程</h4>
<figure>
<img src="https://fyindex.work/PicGo/image-20240928150325842.png"
alt="image-20240928150325842" />
<figcaption aria-hidden="true">image-20240928150325842</figcaption>
</figure>
<p><span class="math inline">\(c_{Daten_f} =AES_{DK}(Daten_f)\)</span>
这个 <span class="math inline">\(c_{Daten_f}\)</span>
存在AP-存储器里</p>
<p><span class="math inline">\(c_{DK}=AES_{CK}(DK)\)</span>, 存在 <span
class="math inline">\(f\)</span> 的 Meta Data里</p>
<p>用 <span class="math inline">\(K\)</span> 加密 <span
class="math inline">\(f\)</span> 的 Meta Data</p>
<p><span class="math inline">\(c_K=AES_{KS}(K)\)</span>,
KS从UID导出来，只在SEP被访问</p>
<h4 id="文件解密过程">文件解密过程</h4>
<p>在启动时候，从UID把KS算出来，从AP存储器读取EK</p>
<p>解密：<span class="math inline">\(c_K= AES^{-1}_{EK}(c_{c_k}), K =
AES^{-1}_{KS}(c_k)\)</span></p>
<p>然后用 <span class="math inline">\(K\)</span> 解密MetaData 就有了 CK
的ID , 有了 <span class="math inline">\(c_{DK}\)</span></p>
<p>用 MS 解密这个，如果要输入密码就输入</p>
<p>对于之后的使用，把 CK 加密 <span
class="math inline">\(c&#39;_{CK}=AES_{K&#39;}(CK), K= K_{eph} ||
UID\)</span> SEP- DRAM speichern</p>
<p>用 CK 解密出 DK，再解密出 <span
class="math inline">\(Daten_f\)</span></p>
<h4 id="vier-sicherheitsklassen">Vier Sicherheitsklassen</h4>
<ul>
<li>Complete Protection: 最强的保护等级</li>
</ul>
<p><strong>设备锁定状态下</strong>，CK
将不可用，因此无法进行后台下载等操作</p>
<p>类密钥 CK 会被 <strong>主密钥 (MS)</strong> 保护并存储在 <strong>AP
闪存</strong> 中。这是为了防止未经授权的访问。</p>
<p>同时，CK 和文件密钥 (DK) 会被从 <strong>安全环境处理器 (SEP) 的
RAM</strong> 中删除，确保在设备锁定状态下无法访问文件。</p>
<p>需要输入 <strong>密码</strong>，并计算主密钥
(MS)。这需要物理访问设备（即设备的
<strong>UID</strong>），确保只有合法用户能够进行此操作。</p>
<p>计算主密钥 (MS) 后，CK 被解密。</p>
<p>使用解密后的 CK，可以访问并解密对应的文件密钥
(DK)，从而访问文件的数据</p>
<ul>
<li><p>Protected Until First User Authentication</p>
<p>在此保护等级下，<strong>类密钥 (CK)</strong>
在设备首次解锁时被解密，并且在设备锁定时不会从 <strong>安全环境处理器
(SEP) 的 RAM</strong> 中删除。</p>
<p>CK 仅在设备重启时才会被清空，这意味着 CK
在设备锁定期间依然可用。当设备处于锁定状态时，CK 会保留在 SEP-RAM
中</p></li>
</ul>
<p>​ 此保护级别通常是 <strong>所有第三方应用程序</strong>
的默认保护等级。</p>
<ul>
<li><p>No Protection</p>
<p>这是文件保护的默认等级，适用于所有未明确指定保护类别的文件。在无保护级别下，CK
仅使用设备的 <strong>UID</strong> 进行加密。</p>
<p>文件密钥 (DK) 使用 CK 加密。</p>
<p>文件的元数据则使用 <strong>文件系统密钥 (K)</strong> 加密。</p></li>
<li><p>Protected Unless Open</p>
<p>允许对打开的文件进行写入访问，即使设备处于锁定状态。这意味着只要文件处于打开状态，就不会受到保护。</p>
<p>例如，在设备锁定的情况下，用户可以继续下载电子邮件附件</p>
<ul>
<li>由于 CK 和 DK 在设备锁定后不再存储在 SEP-RAM
中，这就导致在锁定状态下无法访问这些密钥。这可能会造成无法进行写入操作的问题，尤其是当文件仍然需要保存时。</li>
</ul>
<p><strong>重新访问要求</strong>:</p>
<ul>
<li>一旦文件关闭，若需要再次访问该文件，则用户必须重新输入
Passcode。这种设计确保了对数据的安全性，但在用户体验上可能造成不便。</li>
</ul></li>
</ul>
<p>解决方法：</p>
<p>CK是一个 ECC keypair <span class="math inline">\((e_{class},
d_{class})\)</span> , <span class="math inline">\(d_{class}\)</span> 被
MS 保护, <span class="math inline">\(e\)</span> 在AP里可以被访问</p>
<p><strong>在创建文件的时候</strong>：生成 <span
class="math inline">\((e_{file},d_{file})\)</span> , <span
class="math inline">\(s=ECDH(d_{file},e_{class})\)</span></p>
<p>包装 <span class="math inline">\(c_{DK}=AES_s(DK)\)</span> , <span
class="math inline">\(s\)</span> 留在 SEP-RAM</p>
<p><span class="math inline">\(c_{DK},e_{file}\)</span> 保存在 f 的 Meta
Data里面，删除 <span class="math inline">\(d_{file}\)</span></p>
<h4 id="文件重新打开时-dk-的恢复过程">文件重新打开时 DK 的恢复过程</h4>
<h2 id="funknetze-im-nahbereich">Funknetze im Nahbereich</h2>
<p>Ziel: Sicherheitsprobleme und -konzepte für Funknetze im
Nahbereich</p>
<h3 id="sicherheit-bei-funkkommunikation">5.1 Sicherheit bei
Funkkommunikation</h3>
<p><strong>自组织模式（Ad-hoc）：</strong></p>
<ul>
<li>自组织模式没有中心设备，网络中的设备可以直接彼此通信。这种模式通常用于临时的、无需AP的网络连接，比如两台笔记本之间的直接文件传输</li>
</ul>
<p><strong>基础设施模式（Infrastruktur-basiert）：</strong></p>
<ul>
<li>在基础设施模式的无线网络中，通信通过一个中心设备进行，例如无线路由器或接入点（Access
Point,
AP）。所有设备都必须通过AP进行通信，AP负责管理和协调网络中的通信。</li>
</ul>
<p>在无线通信中，安全问题主要来自以下几个方面：</p>
<h4 id="sniffen窃听"><strong>1. Sniffen（窃听）</strong></h4>
<ul>
<li><strong>无线信号的广泛传播</strong>：
无线电波具有很大的传播范围，攻击者可以从很远的距离截获无线信号进行监听。像<strong>WLAN
802.11系列标准</strong>这样的技术，根据版本不同，通信范围可以从<strong>100米</strong>到<strong>几公里</strong>不等。</li>
<li><strong>信号的垂直传播</strong>：
无线信号不仅水平传播，还可以垂直传播，意味着楼层之间也可以传播信号。</li>
<li><strong>物理障碍的局限性</strong>：
虽然墙壁可能会部分阻挡信号，但它们并不能完全屏蔽无线电波。因此，即使在封闭的环境中，信号仍然有可能被外部捕捉到。</li>
</ul>
<h4 id="spoofen伪造"><strong>2. Spoofen（伪造）</strong></h4>
<ul>
<li><p>可操控的MAC地址或蓝牙设备地址</p>
<p>：
攻击者可以通过伪造设备的MAC地址或蓝牙设备地址来假冒合法设备。这会导致以下几种攻击方式：</p>
<ul>
<li><strong>客户端伪装（Client
Spoofing）</strong>：攻击者假冒合法客户端进行通信，窃取信息或执行恶意操作。</li>
<li><strong>会话劫持（Session
Hijacking）</strong>：攻击者在通信过程中劫持会话，获取敏感数据或接管控制权。</li>
<li><strong>接入点伪装（Access Point
Spoofing）</strong>：攻击者创建一个假接入点，诱导合法设备连接，从而进行中间人攻击</li>
</ul></li>
</ul>
<h3
id="anforderungen-an-sicherheitsarchitekturen-für-layer-2">Anforderungen
an Sicherheitsarchitekturen für Layer 2</h3>
<ul>
<li><strong>设备之间的相互认证</strong>：在建立第2层连接时，所有设备都需要进行<strong>双向认证</strong>，以确保通信双方都是合法的并且可以信任。这种认证可以防止未经授权的设备接入网络。</li>
<li><strong>使用先进的加密标准</strong>
<ul>
<li>应该采用当前最先进的加密技术来保护数据的机密性。这确保即使数据在传输过程中被截获，攻击者也无法读取内容。</li>
</ul></li>
<li><strong>通过加密的哈希函数实现数据完整性保护</strong>
<ul>
<li>数据的完整性需要通过<strong>加密哈希函数</strong>来保护，确保传输的数据没有被篡改。哈希函数生成的数据摘要可以用于验证接收到的数据是否与原始数据一致</li>
</ul></li>
<li><strong>密钥管理
</strong>不同的任务或用途（例如加密、认证、完整性检查等）应使用<strong>不同的密钥</strong>，以减少安全风险，密钥长度应足够长，以防止暴力破解。对称密钥应具有<strong>高熵</strong>，即密钥的随机性要足够高，确保难以被预测或推断，每次P2P（点对点）连接应生成一个新的<strong>会话密钥</strong>，避免重复使用相同的密钥，尤其是在使用<strong>流加密</strong>的情况下，防止密钥重用带来的安全问题</li>
<li><strong>理想的安全特性</strong>
<ul>
<li>在每个具体服务（例如文件共享、语音通信等）上，实现细粒度的密钥管理，以确保每个服务都有适当的安全保护</li>
<li>无线设备中存储的数据应受到<strong>访问控制</strong>，确保只有经过授权的用户或设备可以访问这些数据。</li>
<li>Nutzer-Authentisierung<strong>用户身份认证</strong>，确保操作设备的人也是授权的用户。这可以防止设备被盗用或滥用</li>
</ul></li>
</ul>
<h3 id="wlan-sicherheit-wpa-wifi-protcted-access">WLAN-Sicherheit, WPA
(WiFi Protcted Access)</h3>
<p>WPA是一种用于保护WLAN网络的安全协议，其中最新版本为<strong>WPA3</strong>。以下是WPA2中关于<strong>密钥层次结构</strong>的详细解释：</p>
<h4
id="密钥层次结构中的主要概念"><strong>密钥层次结构中的主要概念</strong></h4>
<ol type="1">
<li><strong>根密钥：Pairwise Master Key (PMK)</strong>
<ul>
<li><strong>PMK</strong>是整个密钥层次结构的根密钥，具有<strong>256位</strong>的长度，用于在接入点（AP）和WLAN客户端之间建立安全连接。它是一个<strong>持久的密钥</strong>，在会话开始时生成并保持较长时间。</li>
<li>PMK通过以下两种方式建立：
<ol type="1">
<li>个人模式（Personal Mode，PSK）
<ul>
<li>主要基于<strong>预共享密钥（Pre-shared
Key，PSK）</strong>，通常是密码或通过<strong>WPS-PIN（Wi-Fi Protected
Setup）</strong>按钮设置。</li>
</ul></li>
<li>企业模式（Enterprise Mode）
<ul>
<li>通过<strong>802.1X协议</strong>进行身份认证，适用于需要更强身份验证和访问控制的企业环境。</li>
</ul></li>
</ol></li>
</ul></li>
<li><strong>会话密钥：Pairwise Transient Key (PTK)</strong>
<ul>
<li><strong>PTK</strong>是每个会话的临时密钥，长度为<strong>384位</strong>，通过<strong>密钥派生函数（Key
Derivation Function, KDF）</strong>从PMK中派生而来。</li>
<li>PTK由<strong>4次握手协议</strong>（4-way Handshake
Protocol）在客户端和AP之间协商生成，用于保护单个客户端的通信。</li>
<li>PTK分为三个部分：
<ul>
<li><strong>TK（Temporary Key）</strong>：用于数据加密。</li>
<li><strong>KCK（Key Confirmation
Key）</strong>：用于确认密钥的完整性。</li>
<li><strong>KEK（Key Encryption Key）</strong>：用于加密密钥信息。</li>
</ul></li>
</ul></li>
<li><strong>组密钥：Group Temporal Key (GTK)</strong>
<ul>
<li><strong>GTK</strong>是一个临时的组密钥，用于在WLAN网络中实现安全的<strong>组播和多播通信</strong>。它由接入点（AP）生成，长度为<strong>128位</strong>。</li>
<li>组密钥用于确保在同一无线局域网（WLAN）中，所有用户的组通信数据都是安全的</li>
</ul></li>
</ol>
<p><strong>PTK = TK || KCK || KEK</strong>
是在WPA2中通过4次握手协议生成的临时密钥，用于保护无线通信。PTK由以下三个部分组成：</p>
<p><strong>1. TK (Temporal Key) - 临时密钥</strong></p>
<ul>
<li><strong>长度：128位</strong></li>
<li>用于加密AP和客户端之间的通信。</li>
<li>常用于<strong>AES-CCMP</strong>加密算法，确保数据在传输过程中被加密，防止数据泄露。</li>
</ul>
<p><strong>2. KCK (Key Confirmation Key) - 密钥确认密钥</strong></p>
<ul>
<li><strong>长度：128位</strong></li>
<li>用于验证数据的完整性和身份的真实性，特别是在4次握手协议中（用于建立安全连接）。</li>
<li>基于<strong>AES-CBC</strong>算法，确保通信双方能够验证传输的数据是否被篡改。</li>
</ul>
<p><strong>3. KEK (Key Encryption Key) - 密钥加密密钥</strong></p>
<ul>
<li><strong>长度：128位</strong></li>
<li>用于加密从AP到客户端传输的<strong>组密钥（GTK）</strong>。</li>
<li>KEK确保GTK的安全传输，防止组播和多播通信中的数据被攻击者拦截。</li>
</ul>
<h3 id="wpa-4-wege-handshake">WPA 4-Wege-Handshake</h3>
<figure>
<img src="https://fyindex.work/PicGo/image-20241004161649250.png"
alt="image-20241004161649250" />
<figcaption aria-hidden="true">image-20241004161649250</figcaption>
</figure>
<h4 id="aes-ccmp-counter-mode-cbc-mac-protocol">AES-CCMP
(Counter-Mode-CBC-MAC-Protocol)</h4>
<figure>
<img src="https://fyindex.work/PicGo/image-20241005202557607.png"
alt="image-20241005202557607" />
<figcaption aria-hidden="true">image-20241005202557607</figcaption>
</figure>
<p>summerize the effect</p>
<p><a href="mailto:manuel.brosch@tum.de">manuel.brosch@tum.de</a></p>
<p>fault_resistant_neural_networks sw_targets protocol Src
mac_with_an_code.s</p>
<p>https://gitlab.lrz.de/TUEISEC-Intern/fault_resistant_neural_networks/-/blob/main/sw_targets/protocol/Src/mac_with_an_code.s?ref_type=heads</p>
<p>https://gitlab.lrz.de/TUEISEC-Intern/fault_resistant_neural_networks/-/tree/main/sw_targets?ref_type=heads</p>
<h2 id="练习">练习</h2>
<h3 id="复习0">复习0</h3>
<p>Stream Cipher的CTR, CBC, EBC模式和特点</p>
<p>MAC只用Hash实现有什么不好</p>
<p>MAC用Hash把m在后面有什么不好(MD)</p>
<p>HMAC的好处</p>
<p>DS和MAC的区别</p>
<p>RSA和DH</p>
<p>PFS</p>
<p>Challenge-Response Authentifizierung</p>
<h3 id="第一章">第一章</h3>
<p>Smartcard的使用场景</p>
<p>Authentifizierung und Autorisierung的区别</p>
<p>移动系统的安全要求为什么比静止的高</p>
<p>Hardwareabwehrmaßnahmen， 对 RevEng, Fault,
SideChannel的防御是否有效</p>
<ul>
<li>Dual-Rail-Logic<br />
</li>
<li>Sensorik für Spannung, Licht, Temperatur</li>
<li>Schutzschicht gegen EM-Strahlung</li>
<li>Stromführende Metallschicht</li>
<li>Passivierungsschicht für RAM<br />
</li>
<li>Ionenimplantierte ROM-Codes<br />
</li>
<li>Veränderung des Chip-Designs Scrambling der Leitungen</li>
<li>Busse nicht nach außen führen</li>
</ul>
<p>Softwareabwehrmaßnahmen</p>
<ul>
<li>Side-Channel Dummy-Operationen</li>
<li>Random-WaitStates</li>
<li>Verschlüsselte Kommunikation zwischen Lesegerät und Karte</li>
</ul>
<p>EEPROM需要高电压。有什么攻击方法，怎么防御</p>
<p>PACE</p>
<p>SPA</p>
<h3 id="第三章">第三章</h3>
<p>TPM中 EK,SRK,AIK,OAK,的作用和生成方式</p>
<p>TPM的指令是如何加密的，A可以给TPM发送指令吗</p>
<p>EK是怎么验证的</p>
<p>Binding和Sealing的区别</p>
<p>TPM的AIK证书怎么获得的</p>
<p>应用场景</p>
<p>TEE要解决什么问题</p>
<p>Intel SGX怎么运用</p>
<p>Foreshadow Angriff</p>
<h3 id="第四章">第四章</h3>
<details>
<summary>
Bedrohungen in Funkkommunikation und warum
</summary>
<ul>
<li>Sniffen: Funkwellen eine sehr große Ausbreitung haben, sich in
vertikale Richtung breiten</li>
<li>Spoofen: Client-Spoofing, Session Hijacking, AP Spoofing</li>
</ul>
</details>
<details>
<summary>
Anforderungen an Sicherheitsarchitekturen für Layer 2
</summary>
<ul>
<li>Wechselseitige Authentisierung</li>
<li>State-of-the Art Verschlüsselungs-Standards.</li>
<li>Integritätsschutz</li>
<li>Key-Management</li>
</ul>
</details>
<details>
<summary>
解释 PMK, PTK, GTK
</summary>
<ul>
<li>Pairwise Master Key, langlebig</li>
<li><ol type="1">
<li>Personaal: Pre-shared Key (PSK)</li>
<li>Enterprise: 802.1X-Protokoll</li>
</ol></li>
<li>Pro session: Pairwise Transient Key(PTK)
<ol type="1">
<li>aus PMK abgeleitet</li>
<li>PTK = TK || KCK || KEK</li>
<li>TK: Kommunikationsschlüssel for AES-CCMP</li>
<li>KCK: (Key Confirmation Key) for AES-CBC</li>
<li>KEK: (Key Encryption Key) Wrapen des Group Key</li>
</ol></li>
<li>Temporary Group Key (GTK)
<ol type="1">
<li>for sicheren Gruppen und Multicast</li>
<li>von AP erzeugt</li>
</ol></li>
</ul>
</details>
<details>
<summary>
4-Wege Handshake
</summary>
<ol type="1">
<li><p>AP generiert ANounce: msg1 = ANounce</p></li>
<li><p>Client generiret SNounce, berechnet:</p>
<p>PTK=KCK||KEK||TK</p>
<p>MIC=AES-CBC_{KCK}(msg1||msg2)</p>
<p>msg2 = SNounce || MAC-Addr, MIC</p></li>
<li><p>AP prüft MIC, berechnet:</p></li>
</ol>
<pre><code>MIC&#39;=AES-CBC_&#123;KCK&#125;(msg1 || msg2)
msg3 = AES_&#123;KEK&#125;(GTK), MIC&#39;</code></pre>
<ol start="4" type="1">
<li>Client prüft MIC’, falls ok ACK und activate, msg4 = ACK</li>
<li>AP falls ok, activate</li>
</ol>
</details>
<details>
<summary>
AES-CCMP
</summary>
Klartext: Nutzdaten + MIC Counter from MAC-Header, Paketnummer TK: CTR
Mode Key
</details>
<details>
<summary>
Sicherheitsprobleme bei WPA2
</summary>
<ul>
<li>PMK: Kein paarweiser Master-Key: mehrere Nutzer kennen das Passwort!
Dictionary und Brute Force Attacks auf Passwort</li>
<li>Design-Problem des 4 Wege Handshake: WLAN-KRACK-Angriff (Key
Reinstallation AttaCK)</li>
</ul>
</details>
<details>
<summary>
WPA 3 Personal
</summary>
<ul>
<li>Simultaneous Authentication of Equals (SAE) 1. Ersetzt Pre-shared
Key (PSK) in WPA2-Personal 2. Variante des Dragonfly Handshake 3.
Berechnen eines frischen Pairwise Master Key (PMK)
</details></li>
</ul>
<details>
<summary>
Dragonfly Handshake
</summary>
<ul>
<li><p>Commit-Phase 1. Ableiten eines gemeinsamen Schlüssels aus
Passwort 2. Abstimmen der Kurvenparametern 3. Client und AP bilden
jeweils ihr gemeinsames Passwort auf einen Punkt P der elliptischer
Kurve E ab 4. Schlüsselvereinbarung ähnlich ECDH zwischen Client (A) und
AP (B)</p></li>
<li><p>Confirm-Phase: Prüfen ob beide Seiten identischen Schlüssel
abgeleitet haben</p></li>
</ul>
</details>
<details>
<summary>
Attacken auf WPA3
</summary>
<ul>
<li><p>Downgrade von WPA3 auf WPA2</p></li>
<li><p>Downgrade der WPA3- Handshake Sicherheitsparameter</p></li>
<li><p>Timing Side-Channels auf den WPA3-Handshake: Abbildung des
Passwortes auf finite Gruppe/Kurvenelement erfolgt durch iteratives
Ausprobieren bis passendes Gruppenelement gefunden.</p>
</details></li>
</ul>
<details>
<summary>
Schlüsselhierarchie bei Bluetooth
</summary>
<ul>
<li>Persistenter Link-Key</li>
</ul>
</details>
<details>
<summary>
Secure Simple Pairing (SSP)
</summary>
<ul>
<li>Persistenter Link-Key</li>
</ul>
</details>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://fyind.de">Fyind</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://fyind.de/2024/05/12/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A82/">http://fyind.de/2024/05/12/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A82/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/pic1.PNG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/05/21/windows%E5%AE%89%E8%A3%85/" title="Windows安装"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Windows安装</div></div><div class="info-2"><div class="info-item-1">安装完windows后的设置 键盘要插机箱后面，不然音量旋钮用不了 跳过联网 shift + F10 然后运行 1oobe\bypassnro 安装驱动 在另一台电脑上，去主板官网下载联网驱动 下载显卡驱动gforce experience windows 设置  右键任务栏，一场搜索框，任务视图，小组件 卸载one drive 右键回win10: cmd里面  1reg add &quot;HKCU\Software\Classes\CLSID\&#123;86ca1aa0-34aa-4e8b-a509-50c905bae2a2&#125;\InprocServer32&quot; /f /ve  语言和区域里面加入ENG，DEU windows+E 然后点三个点里面的选项，设置打开时候是此电脑 关掉睡眠,电源里改成最佳能效，关闭睡眠  勾选掉隐私  隐私和安全性里面，勾选掉所有的 声音设置里面，更多设置，windwos声音方案选择无声  关闭杀毒 win+r运行 gpedit.msc 计算机配置，管理模板,windows组件，microsoft defender防病毒,实时防...</div></div></div></a><a class="pagination-related" href="/2024/05/07/%E4%BB%A3%E6%95%B0/" title="代数"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">代数</div></div><div class="info-2"><div class="info-item-1">Algebra Gruppe 集合 \(G\) , 和一种运算 \(G \times G \rightarrow G,(\sigma, \tau) \mapsto \sigma \cdot \tau\)  AG 结合律 \(\forall \sigma, \tau, \rho \in G: \quad(\sigma \cdot \tau) \cdot \rho=\sigma \cdot(\tau \cdot \rho)\) NE 左单位元 \(\exists \iota \in G: \quad \forall \sigma \in G: \quad \iota \cdot \sigma=\sigma\), IE 左逆元 \(\forall \sigma \in G: \quad \exists \sigma^{\prime} \in G: \quad \sigma^{\prime} \cdot \sigma=\iota\)  abelsch (commutative) KG 交换律 \(\forall \sigma, \tau \in G: \quad \sigma \cdot...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/pic1.PNG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Fyind</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">85</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">83</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Fyind"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Fyind" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:tarjan0025@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://jq.qq.com/?_wv=1027&amp;k=d0kMY0nN" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">欢迎来逛逛我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#it-security-2"><span class="toc-number">1.</span> <span class="toc-text">IT Security 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#digitale-identit%C3%A4t-id-token"><span class="toc-number">1.1.</span> <span class="toc-text">Digitale Identität: ID Token</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#formfaktor-smartcard"><span class="toc-number">1.1.1.</span> <span class="toc-text">Formfaktor Smartcard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mikrocontroller-architektur"><span class="toc-number">1.1.2.</span> <span class="toc-text">Mikrocontroller-Architektur</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#control"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Control</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#optionale-co-prozessoren"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">Optionale Co-Prozessoren</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ausgew%C3%A4hlte-angriffe"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 Ausgewählte Angriffe</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#passive-angriffe"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">Passive Angriffe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aktive-angriffe"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">Aktive Angriffe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#manipulation-der-externen-control-peripherals"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">Manipulation der
externen Control Peripherals</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zus%C3%A4tzliche-angriffspunkte"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">Zusätzliche Angriffspunkte</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seitenkanalangriffe"><span class="toc-number">1.1.4.</span> <span class="toc-text">Seitenkanalangriffe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spezielle-schutzma%C3%9Fnahmen-f%C3%BCr-mikrocontroller"><span class="toc-number">1.1.5.</span> <span class="toc-text">Spezielle
Schutzmaßnahmen für Mikrocontroller</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#generelle-abwehrma%C3%9Fnahmen"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">Generelle Abwehrmaßnahmen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sicherheitsma%C3%9Fnahmen"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">Sicherheitsmaßnahmen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#einf%C3%BChrung-spezieller-schichten-shielding"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">Einführung spezieller
Schichten (Shielding)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#einf%C3%BChrung-spezieller-sensoren"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">Einführung spezieller
Sensoren</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#verschl%C3%BCsselung-von-internem-speicher"><span class="toc-number">1.1.5.5.</span> <span class="toc-text">Verschlüsselung von
internem Speicher</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smartcard-secure-element-als-physischer-idtoken"><span class="toc-number">1.1.6.</span> <span class="toc-text">Smartcard,
secure Element als physischer IDToken</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#aushebeln-des-fehlversuchsz%C3%A4hlers-im-eeprom"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">Aushebeln des
Fehlversuchszählers im EEPROM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#angriff-durch-nutzung-eines-unsicheren-card-readers"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">Angriff
durch Nutzung eines unsicheren Card-Readers</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pace-password-authenticated-connection-establishment"><span class="toc-number">1.1.7.</span> <span class="toc-text">PACE
(Password Authenticated Connection Establishment)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#identit%C3%A4tsmanagement-im"><span class="toc-number">1.2.</span> <span class="toc-text">Identitätsmanagement (IM)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#single-sign-on-konzept"><span class="toc-number">1.2.1.</span> <span class="toc-text">Single-Sign-On Konzept</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">问题：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3single-sign-on-sso"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">解决Single-Sign-on SSO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#konsequenz-aufgaben-trennung-ist-m%C3%B6glich"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">Konsequenz:
Aufgaben-Trennung ist möglich</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#f%C3%B6derierte-identit%C3%A4ten%E8%81%94%E5%90%88%E8%BA%AB%E4%BB%BD"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">Föderierte
Identitäten联合身份</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#im-protokolle-in-der-praxis"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">IM-Protokolle in der Praxis</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberos-system"><span class="toc-number">1.2.2.</span> <span class="toc-text">Kerberos-System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shibboleth"><span class="toc-number">1.2.3.</span> <span class="toc-text">Shibboleth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#openid-connect-basierend-auf-oauth-2.0"><span class="toc-number">1.2.4.</span> <span class="toc-text">OpenID Connect basierend
auf OAuth 2.0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#oauth-2.0"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">OAuth 2.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#openid-connect"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">OpenID Connect</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#self-sovereign-identity-ssi"><span class="toc-number">1.2.5.</span> <span class="toc-text">Self-sovereign Identity (SSI)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kapitel-3-hardware-basierte-sicherheit"><span class="toc-number">1.3.</span> <span class="toc-text">Kapitel 3
Hardware-basierte-Sicherheit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#trusted-computing"><span class="toc-number">1.3.1.</span> <span class="toc-text">Trusted Computing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#trust-building-blocks-der-tc-plattform"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Trust Building Blocks
der TC-Plattform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#features-des-tpm"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Features des TPM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tpm-schl%C3%BCsselhierarchie"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">TPM-Schlüsselhierarchie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nutzen-der-schl%C3%BCsselhierarchie"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">Nutzen der
Schlüsselhierarchie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#measured-boot"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">Measured Boot</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#attestierung"><span class="toc-number">1.3.1.6.</span> <span class="toc-text">Attestierung</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trusted-execution-environment-tee---%E4%BF%A1%E4%BB%BB%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.3.2.</span> <span class="toc-text">Trusted
Execution Environment (TEE) - 信任执行环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#intel-software-guard-extensionssgx"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Intel Software Guard
Extensions(SGX)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#intel-trusted-domain-extensions-tdx"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Intel Trusted Domain
Extensions (TDX)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#amd-secure-encrypted-virtualization-sev"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">AMD Secure Encrypted
Virtualization (SEV)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ios-sicherheit"><span class="toc-number">1.4.</span> <span class="toc-text">iOS Sicherheit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ios-%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.1.</span> <span class="toc-text">iOS 安全架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hardware-sicherheit"><span class="toc-number">1.4.2.</span> <span class="toc-text">Hardware-Sicherheit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sep-schl%C3%BCssel"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">SEP-Schlüssel</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passcodes"><span class="toc-number">1.4.3.</span> <span class="toc-text">Passcodes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#master-key"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">Master Key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E4%B8%8E%E8%AE%BE%E5%A4%87-uid-%E7%BB%91%E5%AE%9A"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">密码与设备 UID 绑定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#biometrie-face-id-und-touch-id"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">Biometrie: Face ID und Touch
ID</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#datei-schutz-data-protection"><span class="toc-number">1.4.4.</span> <span class="toc-text">Datei-Schutz, Data Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">文件加密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">文件解密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vier-sicherheitsklassen"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">Vier Sicherheitsklassen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E9%87%8D%E6%96%B0%E6%89%93%E5%BC%80%E6%97%B6-dk-%E7%9A%84%E6%81%A2%E5%A4%8D%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">文件重新打开时 DK 的恢复过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#funknetze-im-nahbereich"><span class="toc-number">1.5.</span> <span class="toc-text">Funknetze im Nahbereich</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sicherheit-bei-funkkommunikation"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 Sicherheit bei
Funkkommunikation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sniffen%E7%AA%83%E5%90%AC"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">1. Sniffen（窃听）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spoofen%E4%BC%AA%E9%80%A0"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">2. Spoofen（伪造）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#anforderungen-an-sicherheitsarchitekturen-f%C3%BCr-layer-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">Anforderungen
an Sicherheitsarchitekturen für Layer 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wlan-sicherheit-wpa-wifi-protcted-access"><span class="toc-number">1.5.3.</span> <span class="toc-text">WLAN-Sicherheit, WPA
(WiFi Protcted Access)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%BB%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">密钥层次结构中的主要概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wpa-4-wege-handshake"><span class="toc-number">1.5.4.</span> <span class="toc-text">WPA 4-Wege-Handshake</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#aes-ccmp-counter-mode-cbc-mac-protocol"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">AES-CCMP
(Counter-Mode-CBC-MAC-Protocol)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.6.</span> <span class="toc-text">练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A00"><span class="toc-number">1.6.1.</span> <span class="toc-text">复习0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0"><span class="toc-number">1.6.2.</span> <span class="toc-text">第一章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0"><span class="toc-number">1.6.3.</span> <span class="toc-text">第三章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0"><span class="toc-number">1.6.4.</span> <span class="toc-text">第四章</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/17/C-%E9%AB%98%E6%80%A7%E8%83%BD%E7%BC%96%E7%A8%8B/" title="C++高性能编程">C++高性能编程</a><time datetime="2025-07-17T19:47:19.000Z" title="Created 2025-07-17 19:47:19">2025-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/" title="操作系统概念">操作系统概念</a><time datetime="2025-07-16T20:55:14.000Z" title="Created 2025-07-16 20:55:14">2025-07-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/15/Kubuntu%E9%85%8D%E7%BD%AE/" title="Kubuntu配置">Kubuntu配置</a><time datetime="2025-07-15T05:25:37.000Z" title="Created 2025-07-15 05:25:37">2025-07-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/12/%E6%88%91%E4%BB%AC%E5%9C%A8AI%E6%97%B6%E4%BB%A3%E8%AF%A5%E5%A6%82%E4%BD%95%E5%AD%A6%E4%B9%A0/" title="我们在AI时代该如何学习">我们在AI时代该如何学习</a><time datetime="2025-07-12T23:12:19.000Z" title="Created 2025-07-12 23:12:19">2025-07-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/12/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CA-Top-Down-Approach/" title="计算机网络A Top Down Approach">计算机网络A Top Down Approach</a><time datetime="2025-07-12T22:02:58.000Z" title="Created 2025-07-12 22:02:58">2025-07-12</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Fyind</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'all',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>